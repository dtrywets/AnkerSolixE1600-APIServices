const BASE_LOCATION="";let sitemap=null,schedule=null;const renderSitemap=async function(){if(null==sitemap)return;let e="";e+='<div class="row">',e+='<div class="col-8">',e+='<h2 class="text-primary">'+sitemap.site_list[0].site_name+"</h2>",e+="</div>",e+='<div class="col text-end"><div class="input-group"><span class="input-group-text">Appliance Load</span>',e+='<select id="prevEnergy" class="form-control"><option value="0">0W (Off)</option></select>',e+="</div>",e+="</div>",e+="</div>",e+="<hr/>",e+='<div class="row"><div class="col-1">&nbsp;</div><div class="col-9">';for(let t=0;t<sitemap.solarbank_list.length;t++)e+='<div class="card shadow">',e+='<div class="card-header"><h3 class="card-title">'+sitemap.solarbank_list[t].device_name+"</h3></div>",e+='<div class="card-body">',e+='<div class="row">',e+='<div class="col-3 align-self-center text-center">',e+='<img src="'+sitemap.solarbank_list[t].device_img+'" class="img-fluid" alt="Responsive image">',e+="</div>",e+='<div class="col-9">',e+='<table class="table" width="100%">',e+='<tr><td><strong>State of Charge (SoC)</strong></td><td class="text-right">'+sitemap.solarbank_list[t].battery_power+"%</td></tr>",e+='<tr><td><strong>Charging Power</strong></td><td class="text-right">'+sitemap.solarbank_list[t].charging_power+"W</td></tr>",e+='<tr><td><strong>Output Power</strong></td><td class="text-right">'+sitemap.solarbank_list[t].output_power+"W</td></tr>",e+='<tr><td><strong>PV Power</strong></td><td class="text-right">'+sitemap.solarbank_list[t].photovoltaic_power+"W</td></tr>",e+="</table>",e+="</div>",e+="</div>",e+="</div>",e+='<div class="card-footer"></div>',e+="</div>";e+="</div></div>",$("#sitemap").html(e)},renderSchedule=async function(){if(null==schedule)return;$("#prevEnergy").off(),$("#prevEnergy").attr("disabled","disabled");let e='<option value="0">0W (Off)</option>';for(let t=1*schedule.min_load;t<1*schedule.max_load;t+=1*schedule.step){let s="";schedule.ranges.length>0&&t==schedule.ranges[0].appliance_loads[0].power&&(s="selected"),e+='<option value="'+t+'" '+s+">"+t+"W</option>"}$("#prevEnergy").html(e),$("#prevEnergy").on("change",(function(e){$("#prevEnergy").attr("disabled","disabled"),$.getJSON("/setEnergy/?power="+$(this).val(),(function(e){$("#prevEnergy").removeAttr("disabled")}))})),$("#prevEnergy").removeAttr("disabled")};$(document).ready((async function(){$("#loginForm").on("submit",(function(e){e.preventDefault(),$("#infoAlert").hide(),$("#loginBtn").attr("disabled","disabled");let t={ANKER_USERNAME:$("#username").val(),ANKER_PASSWORD:$("#password").val(),ANKER_COUNTRY:$("#country").val().toUpperCase()};$.ajax({url:"/login",type:"POST",contentType:"application/json",data:JSON.stringify(t),success:function(e){console.log(e)},error:function(e){$("#infoAlert").html("Authentication Error: "+e.msg),$("#infoAlert").show(),console.error("Fehler beim Senden der Anfrage: ",e),$("#loginBtn").removeAttr("disabled")}})})),$("#loginModal").modal("show"),$.getJSON("/getHomepage",(function(e){sitemap=e,renderSitemap(),setTimeout((function(){$("#loginModal").modal("hide")}),500),$.getJSON("/schedule/",(function(e){schedule=e,renderSchedule()}))})).fail((function(e){$("#loginBtn").removeAttr("disabled"),console.log("E", e.responseJSON);}))})),void 0!==navigator.serviceWorker&&navigator.serviceWorker.register("sw.js");